# aws-ec2-ssh-hands-on

## 前提条件(準備しておいて欲しいこと)
- AWSアカウントを作成していること
- VPCを作れる状態であること

## お題目
1. VPCを作成する
2. EC2インスタンスを作成する
3. インスタンスに接続する
4. 時間があればおまけ

### (1)VPCを作成する
今回は東京リージョンに作成します。  
右上のリージョンが東京リージョンになっていることを確認して下さい。
<img src="./images/スクリーンショット 2024-05-23 22.31.29.png" />
VPCを作成していきます。  
VPCを作成ボタンを押して、VPCの設定をしていきます。  
今回は時間が限られているため、  
VPCなどを選択します。
<img src="./images/スクリーンショット 2024-05-23 22.35.59.png" />
入力項目は以下のとおりです。  
- 名前タグの自動生成：ec2-ssh-handson
- IPv4 CIDRブロック：10.0.0.0/16
- IPv6 CIDRブロック：ブロックなし
- テナンシー：デフォルト
- AZの数：1
- パブリックサブネットの数：1
- プライベートサブネットの数：0
- NATゲートウェイ：なし
- VPCエンドポイント：なし
- DNSホスト名を有効化：チェックあり
- DNS解決を有効化：チェックあり  

にして、VPCを作成ボタンを押します。  

<img src="./images/スクリーンショット 2024-05-23 22.39.02.png" />

作成が完了すると以下の画面が表示されるので、  
VPCを表示ボタンをクリックして下さい。  
<img src="./images/スクリーンショット 2024-05-23 22.39.53.png" />

現状で作成されたリソースは以下のとおりです。  
- VPC
- パブリックサブネット
- ルートテーブル
- インターネットゲートウェイ  

**ルートテーブルがどのサブネットに関連づけられていて、どのような設定がされているかを見てみましょう。**

### (2)EC2インスタンスを作成します

EC2のリソースの画面を開いて下さい。  

<img src="./images/スクリーンショット 2024-05-23 22.44.33.png" />

そして、インスタンスを起動ボタンを押します。  


<img src="./images/スクリーンショット 2024-05-23 22.46.02.png" />

以下のように入力していきます。

- 名前：ec2-ssh-handson-ec2
- Amazonマシンイメージ：Amazon Linux 2 AMI(HVM)無料利用枠のやつ
- アーキテクチャ：64ビット(x86)
- AMI ID：ami-0d0150aa305b7226d
- インスタンスタイプ：t2.micro(無料利用枠)
- キーペア：新しいキーペアの作成
- キーペア名：ec2-ssh-handson-ec2-key-pair
- キーペアのタイプ：RSA
- プライベートキーファイル形式：.pem  

キーペアを作成ボタンを押します。

ネットワーク設定の編集ボタンを押します。

- VPC：先ほど作成したものを選択する
- サブネット：勝手に選択される
- パブリックIPの割り当て：有効化
- セキュリティグループ：セキュリティグループを作成
- セキュリティグループ名：ec2-ssh-handson-ec2-sg
- 説明：ec2-ssh-handson-ec2-sg
- セキュリティグループルール(タイプ)：ssh
- セキュリティグループルール(プロトコル)：TCP
- セキュリティグループルール(ポート範囲)：22
- セキュリティグループルール(ソースタイプ)：自分のIP
- 高度なネットワーク設定：何も触らなくてOK
- ストレージを設定：何も触らなくてOK
- 高度な詳細：何も触らなくてOK  

最後にインスタンスを起動ボタンを押します。
<img src="./images/スクリーンショット 2024-05-23 23.06.27.png" />
押した後の画面
<img src="./images/スクリーンショット 2024-05-23 23.09.58.png" />
その後がこう
<img src="./images/スクリーンショット 2024-05-23 23.10.02.png">

### (3)インスタンスに接続します
準備が整ったので、インスタンスに接続します。  
まずは、先ほどダウンロードしたキーペア(.pemファイル)があるディレクトリにターミナルで移動します。  

<img src="./images/スクリーンショット 2024-05-23 23.56.20.png" />

次に、pemファイルのパーミッションを変更します。
```
chmod 600 ec2-ssh-handson-ec2-key-pair.pem
```

変更すると下のようになります。

<img src="./images/スクリーンショット 2024-05-23 23.57.29.png" />

最後に下のコマンドでec2にsshで接続します。

```
ssh -i ec2-ssh-handson-ec2-key-pair.pem ec2-user@43.207.72.175
```

上の、IPアドレスは、AWSコンソールのEC2からパブリックIPアドレスをコピーします。  

<img src="./images/スクリーンショット 2024-05-23 23.58.37.png" />

これで接続が完了しました。  

(※Are you sure you want to continue connecting (yes/no/[fingerprint])? はyesと答えて下さい)

<img src="./images/スクリーンショット 2024-05-24 0.00.07.png" />

完了！！！

時間があったらおまけでlinuxにて、ユーザーの作成を行い、そのユーザーからssh接続できるかを試してみます。  

<span style="color:green; font-weight:bold;">最後に必ずリソースを削除しましょう！！<span>


















